{% extends 'cosite/globalBase.html' %}

{% block pageTitle %}Collaborative Optimization{% endblock %}
{% load staticfiles %}

{% block pageHeader %}
{% endblock %}

{% block pageBody %}

        <div class="type-report">
        </div>
            <div class = "content-header">
                <div class = "leftside-content-header">
                    <ul class="breadcrumbs">
                        <li><i class="fa fa-files-o" aria-hidden="true"></i><a href="#">测试报告</a></li>
                        <li><a>vBRAS性能对比测试报告</a></li>
                    </ul>
                </div>
            </div>

<div class="report-list-content">
    <div class="report-tab-change">
         <span id="report-style1">同厂家同网元不同版本</span>
         <span id="report-style2">不同厂家同网元最新版本</span>
    </div>



    <div class="report-style1">
        <div class="report-config">
            <!-- 配置所需对比测试报告的相关信息 -->
             <!-- 当对比类型为同厂家同网元不同版本时，下面内容显示 -->
                <select>
                    <option selected disabled>请选择厂家</option>
                    <option value="zhongXing">中兴</option>
                   <option value="huaWei">华为</option>
                   <option value="nokia">诺基亚</option>
                   <option value="cisco">思科</option>
                   <option value="ericsson">爱立信</option>
                   <option value="certus">赛特斯</option>
                   <option value="h3c">华三</option>
                </select>
                <select>
                    <option selected disabled>请选择网元</option>
                    <option value="1">网元 1</option>
                    <option value="2">网元 2</option>
                    <option value="3">网元 3</option>
                </select>
                <!-- 初期默认每个厂家的最新三个版本 版本选择禁用了 -->
                <select disabled>
                    <option>Version 1</option>
                    <option>Version 2</option>
                    <option>Version 3</option>
                    <option selected disabled>请选择版本</option>
                </select>
            <button id="version-report-btn">确定</button>
        </div>
    </div>

    <div class="report-style2">
        <div class="report-config">
            <div id="vendor-choose">
                <p>请选择厂家</p>
                <label><input type="checkbox" value="zhongXing"><span>中兴</span></label>
                <label><input type="checkbox" value="huaWei"><span>华为</span></label>
                <label><input type="checkbox" value="nokia"><span>诺基亚</span></label>
                <label><input type="checkbox" value="cisco"><span>思科</span></label>
                <label><input type="checkbox" value="ericsson"><span>爱立信</span></label>
                <label><input type="checkbox" value="certus"><span>赛特斯</span></label>
                <label><input type="checkbox" value="h3c"><span>华三</span></label>
            </div>
            <div id="netNode-choose">
                <p>请选择网元</p>
                <label><input type="radio" name="netType" value="1">网元1</label>
                <label><input type="radio" name="netType" value="2">网元2</label>
                <label><input type="radio" name="netType" value="3">网元3</label>
            </div>
             <button id="vendor-report-btn">确定</button>
        </div>

    </div>
</div>


<div class="report-table" id="version-report-table">
<button onclick="method1(mytableExcel)"><a>导出表格</a></button>

            <table id="mytableExcel">
                <caption class="report-type"><span id="vendor-name">Vendor-Name</span>——vBRAS性能对比测试报告</caption>

                    <thead>

                        <tr id="table-type-version">
                            <th>测试项</th>
                            <th>测试标准</th>
                            <!-- <th>version 1</th>
                            <th>version 2</th>
                            <th>version 3</th> -->
                        </tr>
                    </thead>

                    <tbody id="version-tbody">
                            <tr>
                                <th rowspan = "4">PPPoE并发会话容量测试</th>
                                <th>最大平均会话容量</th>
                                <!-- <td>暂无数据</td>
                                <td>暂无数据</td>
                                <td>暂无数据</td> -->
                            </tr>
                            <tr>
                                <th>新建平均会话速率</th>
                                <!-- <td>暂无数据</td>
                                <td>暂无数据</td>
                                <td>暂无数据</td> -->
                            </tr>
                            <tr>
                                <th>新建最小会话速率</th>
                                    <!-- <td>暂无数据</td>
                                    <td>暂无数据</td>
                                    <td>暂无数据</td> -->
                            </tr>
                            <tr>
                                <th>需要的最大内存</th>
                                <!-- <td>暂无数据</td>
                                <td>暂无数据</td>
                                <td>暂无数据</td> -->
                            </tr>


                            <tr>
                                <th rowspan = "7">用户侧转发性能测试</th>
                                <th>64字节转发性能</th>
                                <!-- <td>暂无数据</td>
                                <td>暂无数据</td>
                                <td>暂无数据</td> -->
                            </tr>
                            <tr>
                                <th>128字节转发性能</th>
                                <!-- <td>暂无数据</td>
                                <td>暂无数据</td>
                                <td>暂无数据</td> -->
                            </tr>
                            <tr>
                                <th>256字节转发性能</th>
                                <!-- <td>暂无数据</td>
                                <td>暂无数据</td>
                                <td>暂无数据</td> -->
                            </tr>
                            <tr>
                                <th>512字节转发性能</th>
                                <!-- <td>暂无数据</td>
                                <td>暂无数据</td>
                                <td>暂无数据</td> -->
                            </tr>
                            <tr>
                                <th>1024字节转发性能</th>
                                <!-- <td>暂无数据</td>
                                <td>暂无数据</td>
                                <td>暂无数据</td> -->
                            </tr>
                            <tr>
                                <th>1280字节转发性能</th>
                                <!-- <td>暂无数据</td>
                                <td>暂无数据</td>
                                <td>暂无数据</td> -->
                            </tr>
                            <tr>
                                <th>1518字节转发性能</th>
                                <!-- <td>暂无数据</td>
                                <td>暂无数据</td>
                                <td>暂无数据</td> -->
                            </tr>


                            <tr>
                                <th rowspan="4">综合上网业务测试</th>
                                <th>最大会话容量</th>
                                <!-- <td>暂无数据</td>
                                <td>暂无数据</td>
                                <td>暂无数据</td> -->
                            </tr>
                            <tr>
                                <th>新建会话速率</th>
                                <!-- <td>暂无数据</td>
                                <td>暂无数据</td>
                                <td>暂无数据</td> -->
                            </tr>
                            <tr>
                                <th>需要的最大内存</th>
                                <!-- <td>暂无数据</td>
                                <td>暂无数据</td>
                                <td>暂无数据</td> -->
                            </tr>

                    </tbody>
                </table>
            </div>
    <div class="report-table" id="vendor-report-table">
    <button onclick="method1(mytableExcel)"><a>导出表格</a></button>
         <table>
            <caption class="report-type"><span id="multi-vendor-name">Vendor-Name</span>——vBRAS性能对比测试报告</caption>
                    <thead>
                        <tr id="table-type-vendor">
                            <th>测试项</th>
                            <th>测试标准</th>
                            <!-- <th>vendor 1</th>
                            <th>vendor 2</th>
                            <th>vendor 3</th> -->
                        </tr>
                    </thead>

                    <tbody id="vendor-tbody">
                            <tr>
                                <th rowspan = "4">PPPoE并发会话容量测试</th>
                                <th>最大平均会话容量</th>
                                <!-- <td>暂无数据</td>
                                <td>暂无数据</td>
                                <td>暂无数据</td> -->
                            </tr>
                            <tr>
                                <th>新建平均会话速率</th>
                                <!-- <td>暂无数据</td>
                                <td>暂无数据</td>
                                <td>暂无数据</td> -->
                            </tr>
                            <tr>
                                <th>新建最小会话速率</th>
                                    <!-- <td>暂无数据</td>
                                    <td>暂无数据</td>
                                    <td>暂无数据</td> -->
                            </tr>
                            <tr>
                                <th>需要的最大内存</th>
                                <!-- <td>暂无数据</td>
                                <td>暂无数据</td>
                                <td>暂无数据</td> -->
                            </tr>


                            <tr>
                                <th rowspan = "7">用户侧转发性能测试</th>
                                <th>64字节转发性能</th>
                                <!-- <td>暂无数据</td>
                                <td>暂无数据</td>
                                <td>暂无数据</td> -->
                            </tr>
                            <tr>
                                <th>128字节转发性能</th>
                                <!-- <td>暂无数据</td>
                                <td>暂无数据</td>
                                <td>暂无数据</td> -->
                            </tr>
                            <tr>
                                <th>256字节转发性能</th>
                                <!-- <td>暂无数据</td>
                                <td>暂无数据</td>
                                <td>暂无数据</td> -->
                            </tr>
                            <tr>
                                <th>512字节转发性能</th>
                                <!-- <td>暂无数据</td>
                                <td>暂无数据</td>
                                <td>暂无数据</td> -->
                            </tr>
                            <tr>
                                <th>1024字节转发性能</th>
                                <!-- <td>暂无数据</td>
                                <td>暂无数据</td>
                                <td>暂无数据</td> -->
                            </tr>
                            <tr>
                                <th>1280字节转发性能</th>
                                <!-- <td>暂无数据</td>
                                <td>暂无数据</td>
                                <td>暂无数据</td> -->
                            </tr>
                            <tr>
                                <th>1518字节转发性能</th>
                                <!-- <td>暂无数据</td>
                                <td>暂无数据</td>
                                <td>暂无数据</td> -->
                            </tr>


                            <tr>
                                <th rowspan="4">综合上网业务测试</th>
                                <th>最大会话容量</th>
                                <!-- <td>暂无数据</td>
                                <td>暂无数据</td>
                                <td>暂无数据</td> -->
                            </tr>
                            <tr>
                                <th>新建会话速率</th>
                                <!-- <td>暂无数据</td>
                                <td>暂无数据</td>
                                <td>暂无数据</td> -->
                            </tr>
                            <tr>
                                <th>需要的最大内存</th>
                                <!-- <td>暂无数据</td>
                                <td>暂无数据</td>
                                <td>暂无数据</td> -->
                            </tr>
                    </tbody>
                </table>

</div>




{#           <div class="type-report">#}
{#        <button  onclick="javascript:method1('mytableExcel')">导出对比测试报告</button>#}
{#    </div>#}

{#   ////////////////////////////////////////        2017/8/3  李勇   ///////////////////////////////////////// #}
<script type="text/javascript" language="javascript">

        var idTmr;
        function  getExplorer() {
            var explorer = window.navigator.userAgent ;
            //ie
            if (explorer.indexOf("MSIE") >= 0) {
                return 'ie';
            }
            //firefox
            else if (explorer.indexOf("Firefox") >= 0) {
                return 'Firefox';
            }
            //Chrome
            else if(explorer.indexOf("Chrome") >= 0){
                return 'Chrome';
            }
            //Opera
            else if(explorer.indexOf("Opera") >= 0){
                return 'Opera';
            }
            //Safari
            else if(explorer.indexOf("Safari") >= 0){
                return 'Safari';
            }
        }
        function method1(tableid) {//整个表格拷贝到EXCEL中
            if(getExplorer()=='ie')
            {
                var curTbl = document.getElementById(tableid);
                var oXL = new ActiveXObject("Excel.Application");

                //创建AX对象excel
                var oWB = oXL.Workbooks.Add();
                //获取workbook对象
                var xlsheet = oWB.Worksheets(1);
                //激活当前sheet
                var sel = document.body.createTextRange();
                sel.moveToElementText(curTbl);
                //把表格中的内容移到TextRange中
                sel.select();
                //全选TextRange中内容
                sel.execCommand("Copy");
                //复制TextRange中内容
                xlsheet.Paste();
                //粘贴到活动的EXCEL中
                oXL.Visible = true;
                //设置excel可见属性

                try {
                    var fname = oXL.Application.GetSaveAsFilename("Excel.xls", "Excel Spreadsheets (*.xls), *.xls");
                } catch (e) {
                    print("Nested catch caught " + e);
                } finally {
                    oWB.SaveAs(fname);

                    oWB.Close(savechanges = false);
                    //xls.visible = false;
                    oXL.Quit();
                    oXL = null;
                    //结束excel进程，退出完成
                    //window.setInterval("Cleanup();",1);
                    idTmr = window.setInterval("Cleanup();", 1);

                }
            }
            else
            {
                tableToExcel(tableid)
            }
        }
        function Cleanup() {
            window.clearInterval(idTmr);
            CollectGarbage();
        }
        var tableToExcel = (function() {
              var uri = 'data:application/vnd.ms-excel;base64,',
              template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><meta http-equiv="Content-Type" charset=utf-8"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>',
                base64 = function(s) { return window.btoa(unescape(encodeURIComponent(s))) },
                format = function(s, c) {
                    return s.replace(/{(\w+)}/g,
                    function(m, p) { return c[p]; }) }
                return function(table, name) {
                if (!table.nodeType) table = document.getElementById(table)
                var ctx = {worksheet: name || 'sheet1', table: table.innerHTML}
                window.location.href = uri + base64(format(template, ctx))
              }
        })()
	</script>

{#  ###############################################  2017/8/3李勇PDF###############################################}
<script type="text/javascript" src="../../static/js/html2canvas.js"></script>
<script src="../../static/js/jsPdf.debug.js"></script>
<script type="text/javascript">

      var downPdf = document.getElementById("print-html2canvas");
      downPdf.onclick = function() {
          html2canvas(document.body, {
              onrendered:function(canvas) {

                  var contentWidth = canvas.width;
                  var contentHeight = canvas.height;

                  //一页pdf显示html页面生成的canvas高度;
                  var pageHeight = contentWidth / 592.28 * 841.89;
                  //未生成pdf的html页面高度
                  var leftHeight = contentHeight;
                  //pdf页面偏移
                  var position = 0;
                  //a4纸的尺寸[595.28,841.89]，html页面生成的canvas在pdf中图片的宽高
                  var imgWidth = 595.28;
                  var imgHeight = 592.28/contentWidth * contentHeight;

                  var pageData = canvas.toDataURL('image/jpeg', 1.0);

                  var pdf = new jsPDF('', 'pt', 'a4');

                  //有两个高度需要区分，一个是html页面的实际高度，和生成pdf的页面高度(841.89)
                  //当内容未超过pdf一页显示的范围，无需分页
                  if (leftHeight < pageHeight) {
                      pdf.addImage(pageData, 'JPEG', 0, 0, imgWidth, imgHeight );
                  } else {
                      while(leftHeight > 0) {
                          pdf.addImage(pageData, 'JPEG', 0, position, imgWidth, imgHeight)
                          leftHeight -= pageHeight;
                          position -= 841.89;
                          //避免添加空白页
                          if(leftHeight > 0) {
                              pdf.addPage();
                          }
                      }
                  }

                  pdf.save('Contrast report.pdf');
              }
          })
      }
</script>
{% endblock %}

{% block pageFooter %}
    <script src="../../static/js/my/compare-vBRAS-frame.js"></script>
   <!--  <script src="../../static/js/examples/charts/chart-js.js"></script>
    <script src="../../static/js/examples/charts/chart-js.js"></script> -->
{% endblock %}